# 软件设计文档

---

## 服务端
### 1. 技术选型及其理由
服务端采用的技术栈为Flask+MySQL

* Flask：使用 Python 编写的轻量级 Web 应用框架，其 WSGI 工具箱采用 Werkzeug
* MySQL：最流行的关系型数据库管理系统之一。

Flask 是一个使用 Python 编写的轻量级Web应用框架，被称为 `microframework`， 因为它使用简单的核心，用 `extension` 增加其他功能。Flask 没有默认使用的数据库、窗体验证工具。 然而，Flask保留了扩增的弹性，可以用 `Flask-extension` 加入这些功能：ORM、窗体验证工具、文件上传、各种开放式身份验证技术。因此 Flask 自由、灵活、可扩展性强， 其丰富的插件可以让我们很容易定制出其他功能，大大降低开发难度，无需重复造轮子。例如 `Flask-login` 可以简单地实现用户登录会话的管理，使用 `flask-sqlalchemy` 可以方便地连接、访问 `Mysql` 数据库

MySQL 是一种关系数据库管理系统，关系数据库将数据保存在不同的表中，而不是将所有数据放在一个大仓库内，这样就增加了速度并提高了灵活性。其体积小、速度快、总体拥有成本低，是中小型项目的很好选择。

### 2. 架构设计
服务端开发主要涉及用户的登录管理，好友关系的管理，消息的发送等，为客户端提供接口。
主要包括：

* model：数据库的模型，对应于 `MySQL` 里的各个表
* router: 路由管理，实现服务端提供给客户端的各种接口（API）
* myemail: 实现发送邮件，主要用于用户注册和找回密码时的邮箱验证码验证

### 3. 模块划分
根据以上设计，划分为数据库模块，路由模块，邮件模块

目录结构如下：
```
├─app：服务端主要代码
│    ├─static：保存图片等资源文件
│    ├─models.py: 数据库模型
│    ├─router.py: 路由管理
│    └─myemail.py: 邮件发送模块
├─venv: virtualenv 虚拟 python 运行环境
├─server.py: 服务器启动代码
├─server.conf: 服务器配置文件
├─requirements.txt：项目依赖列表
└─API.md： 服务端提供的接口描述及使用说明
```

### 4. 设计模式
* 工厂模式：在 `app/__init__.py` 中应用了工厂模式创建一个 `Flask` 对象，对其进行各种必要的初始化配置之后再将其返回，这样外部获取这个对象之后便能直接使用。还能根据不同情况进行不同的配置，即根据不同需求，工厂返回不同的产品。
* 面向对象编程：在项目中处处使用了面向对象思想，大至是数据库模型，邮件模块，小到验证码，都将其封装成一个类，对外提供接口。外部可以通过这些接口来实现对其访问。这样项目耦合度低，修改类的实现时可以保持接口不变，无需更改外部代码。并且易于维护，外部对类的访问必定只能通过接口，有利于减少出错的机会以及错误的定位。



